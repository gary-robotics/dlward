---
layout:     post                    # 使用的布局（不需要改）
title:      Socket.io                # 标题 
subtitle:    第一篇                  #副标题
date:       2019-02-19              # 时间
author:     BY Edlward              # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - gphoto
---
###
与Node http服务器一起使用
Socket io
[Node.js 與 Socket.io – 即時聊天室實作](http://single9.net/2017/12/node-js-%E8%88%87-socket-io-%E5%8D%B3%E6%99%82%E8%81%8A%E5%A4%A9%E5%AE%A4%E5%AF%A6%E4%BD%9C/)  
[無名大猫咪与小狮子](https://www.cnblogs.com/xiezhengcai/default.html?page=1)  
[将Nodejs移植到Arm](https://blog.csdn.net/wanyi3605/article/details/78131241)  
[nodejs&socket.IO 嵌入式linux移植与使用策略](https://blog.csdn.net/xfeng20/article/details/85265146)   
[树莓派3(armv7)下配置node.js](https://blog.csdn.net/weixin_41576693/article/details/80556601)  
[使用nodejs开发树莓派远程控制小车](https://blog.csdn.net/github_33696241/article/details/51756355?utm_source=blogxgwz1)  
[采集rtsp流摄像头到浏览器实时播放方案](https://blog.csdn.net/derek518/article/details/78362183)  
```
node.js版本  0.12.6   下载地址：https://nodejs.org/download/release/v0.12.6/   我用的版本是：node-v0.12.6.tar.gz

arm开发板    SOC是S5PV210 CPU是Cortex A8

交叉编译器是 gcc version 4.4.6 (for CW210 Concenwit Tech)   根据自己个人板子的情况来吧



开始前的准备工作：

export CC=arm-linux-gcc 
export CXX=arm-linux-g++
export LD=arm-linux-ld
export RAINLIB=arm-linux-rainlib
export AR=arm-linux-ar
export CFLAGS=-static
export CXXFLAGS=-static
export LDFLAGS=-static

最后三项是静态编译

这是编译成功后file node的结果：

tarena@ubuntu:/opt/rootfs/node/bin$ file node
node: ELF 32-bit LSB executable, ARM, version 1 (SYSV), statically linked, for GNU/Linux 2.6.32, not stripped



接下来就是

./configure --prefix=/home/tarena/workdir --dest-cpu=arm --without-snapshot

prefix是你make install的文件夹，就是说你想将编译好的node安装的地方

加--without-ssl就编译错误



然后： make  花了一个半小时，看你自己的机器咯

最后： sudo  make install 



最后将编译好拷贝到开发板：node -v   看有没有0.12.6



我还有块arm9的板子，官方是支持armv6到armv8的但是那些源文件是动态链接的，我在自己的板子（armv7）上试过，没得反应，所以才决定自己编译的。

关于node的更高版本，提示错误说要g++ 4.8.0以上版本，交叉编译器找到就不容易了，支持c++ 11恐怕更难找了。

0.12.6是15年发布的，基本上很多模块都能用的，亲测crontab mysql模块都没得问题。

有谁在arm9上编译成功的，一定要留个言。这是我找到的唯一线索，你们可以试试：http://www.nodejs-news.com/nodejs-tech/nodejs-armv5-armv6-howto/



```




```

Node.js嵌入式开发之(一)交叉编译
2018年05月21日 15:59:43 sanallen 阅读数：1350
参考文档
本文档涉及到的目标硬件为全志H8(8核Cortex-A7，Armv7架构)，但是对其他Arm芯片也有一定的借鉴意义，只需要更换交叉编译链即可。

开发环境介绍
主机操作系统：Ubuntu14.04 64位
目标平台：CQA83t 全志H8
交叉工具链：arm-linux-gnueabihf，gcc4.9.2
node.js版本：6.10.0
编译时间：2018.5.21
注意：node.js随着新版本的发布，已经对GCC的版本有一定要求了，具体要求可以查阅node.js代码目录下的BUILDING.md文件。node-v6.10.0对gcc编译器的要求为4.8.0以上。

设置本地编译链和交叉编译链
# 在/etc/bash.bashrc的最后增加如下指令
# Native Compiler
export AR_host="ar"
export CC_host="gcc"
export CXX_host="g++"
export LINK_host="g++"

# Allwinner H8 CQA83t cross compiler
export ARCH=arm
export PATH=/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/:$PATH
export CROSS_COMPILE=arm-linux-gnueabihf-
export CC=/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/arm-linux-gnueabihf-gcc    
export CXX=/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/arm-linux-gnueabihf-g++    
export LD=/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/arm-linux-gnueabihf-ld
export AR=/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/arm-linux-gnueabihf-ar
export AS=/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/arm-linux-gnueabihf-as
export RANLIB=/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/arm-linux-gnueabihf-ranlib
# 修改完成之后需要重启命令行才能生效
# 你可以通过如下指令来确认交叉编译链是否已经设置好
echo $CC 
# 当显示/opt/toolchain/gcc-linaro-arm-linux-gnueabihf-4.9-2014.09_linux/bin/arm-linux-gnueabihf-gcc时表示交叉编译链
# 已经设置好
# 当需要更换为本机编译时屏蔽上面的指令即可
注意：

在进行node.js的编译之前除了设置好交叉编译器之外还要设置本地编译链，否则会出现和issues#18620相同的错误。

配置
./configure --prefix=/usr/local/H8/Ubuntu/node-6.10.0 --dest-cpu=arm --dest-os=linux 
            --cross-compiling --without-snapshot --with-arm-float-abi=hard
注意：

当配置node.js的arm版本时，必须指定--without-snapshot选项，否则会出现错误

编译&安装
make -j8
make install
```
